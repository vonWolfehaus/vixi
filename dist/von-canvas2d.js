!function(){define("Container",["require"],function(){var t=function(){this.uniqueId=Math.random().toString(36).slice(2)+Date.now(),this.children=new LinkedList,this.visible=!0,this.position=new Vec2,this.angle=0,this.alpha=1,this.parent=null,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.regX=0,this.regY=0,this.compositeOperation=null,this.sourceRect=null,this._matrix=new Matrix2,this._scratchPoint=new Point};return t.prototype={draw:function(t){var e,i,n,r=(this.sourceRect,this);for(n=r._matrix.identity(),n.appendTransform(r.position.x,r.position.y,r.scaleX,r.scaleY,r.angle,r.skewX,r.skewY,r.regX,r.regY),t.transform(n.a,n.b,n.c,n.d,n.tx,n.ty),t.globalAlpha*=r.alpha,r.compositeOperation&&(t.globalCompositeOperation=r.compositeOperation),e=this.children.first;e;)i=e.obj,i.visible&&(t.save(),i.draw(t),t.restore()),e=e.next},addChild:function(t){var e,i=arguments.length;if(i>1){for(e=0;i>e;e++)this.addChild(arguments[e]);return arguments[i-1]}return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.add(t),t},removeChild:function(t){return this.children.remove(t)},removeAllChildren:function(){this.children.clear()},sortChildren:function(t){this.children.sort(t)},contains:function(t){for(;t;){if(t===this)return!0;t=t.parent}return!1},toString:function(){return"[Container (name="+this.name+")]"},getStage:function(){for(var t=this;t.parent;)t=t.parent;return t},localToGlobal:function(t,e){var i=this.getConcatenatedMatrix(this._matrix);return null==i?null:(i.append(1,0,0,1,t,e),this._scratchPoint.reset(i.tx,i.ty))},globalToLocal:function(t,e){var i=this.getConcatenatedMatrix(this._matrix);return null==i?null:(i.invert(),i.append(1,0,0,1,t,e),this._scratchPoint.reset(i.tx,i.ty))},localToLocal:function(t,e,i){var n=this.localToGlobal(t,e);return i.globalToLocal(n.x,n.y)},setTransform:function(t,e,i,n,r,a,s,o,l){return this.position.x=t||0,this.position.y=e||0,this.scaleX=null==i?1:i,this.scaleY=null==n?1:n,this.angle=r||0,this.skewX=a||0,this.skewY=s||0,this.regX=o||0,this.regY=l||0,this},getMatrix:function(t){var e=this;return(t?t.identity():new Matrix2).appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.angle,e.skewX,e.skewY,e.regX,e.regY)},getConcatenatedMatrix:function(t){t?t.identity():t=new Matrix2;for(var e=this;null!=e;)t.prependTransform(e.x,e.y,e.scaleX,e.scaleY,e.angle,e.skewX,e.skewY,e.regX,e.regY),e=e.parent;return t}},t}),define("Sprite",["require"],function(){var t=function(t){this.uniqueId=Math.random().toString(36).slice(2)+Date.now(),this.image=t,this.visible=!0,this.position=new Vec2,this.angle=0,this.alpha=1,this.parent=null,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.regX=0,this.regY=0,this.compositeOperation=null,this.sourceRect=null,this._matrix=new Matrix2,this._scratchPoint=new Point};return t.prototype={isVisible:function(){return this.visible&&this.alpha>0&&this.scaleX&&this.scaleY},draw:function(t){var e,i=this.sourceRect,n=this;e=n._matrix.identity(),e.appendTransform(n.position.x,n.position.y,n.scaleX,n.scaleY,n.angle,n.skewX,n.skewY,n.regX,n.regY),t.transform(e.a,e.b,e.c,e.d,e.tx,e.ty),t.globalAlpha*=n.alpha,n.compositeOperation&&(t.globalCompositeOperation=n.compositeOperation),i?t.drawImage(this.image,i.x,i.y,i.width,i.height,0,0,i.width,i.height):t.drawImage(this.image,0,0)},getStage:function(){for(var t=this;t.parent;)t=t.parent;return t},localToGlobal:function(t,e){var i=this.getConcatenatedMatrix(this._matrix);return null==i?null:(i.append(1,0,0,1,t,e),this._scratchPoint.reset(i.tx,i.ty))},globalToLocal:function(t,e){var i=this.getConcatenatedMatrix(this._matrix);return null==i?null:(i.invert(),i.append(1,0,0,1,t,e),this._scratchPoint.reset(i.tx,i.ty))},localToLocal:function(t,e,i){var n=this.localToGlobal(t,e);return i.globalToLocal(n.x,n.y)},setTransform:function(t,e,i,n,r,a,s,o,l){return this.position.x=t||0,this.position.y=e||0,this.scaleX=null==i?1:i,this.scaleY=null==n?1:n,this.angle=r||0,this.skewX=a||0,this.skewY=s||0,this.regX=o||0,this.regY=l||0,this},getMatrix:function(t){var e=this;return(t?t.identity():new Matrix2).appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.angle,e.skewX,e.skewY,e.regX,e.regY)},getConcatenatedMatrix:function(t){t?t.identity():t=new Matrix2;for(var e=this;null!=e;)t.prependTransform(e.x,e.y,e.scaleX,e.scaleY,e.angle,e.skewX,e.skewY,e.regX,e.regY),e=e.parent;return t},toString:function(){return"[Sprite (name="+this.name+")]"}},t})}();